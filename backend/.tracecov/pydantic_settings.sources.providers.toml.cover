    1: """TOML file settings source."""
       
    1: from __future__ import annotations as _annotations
       
    1: import sys
    1: from pathlib import Path
    1: from typing import (
           TYPE_CHECKING,
           Any,
       )
       
    1: from ..base import ConfigFileSourceMixin, InitSettingsSource
    1: from ..types import DEFAULT_PATH, PathType
       
    1: if TYPE_CHECKING:
>>>>>>     from pydantic_settings.main import BaseSettings
       
>>>>>>     if sys.version_info >= (3, 11):
>>>>>>         import tomllib
           else:
>>>>>>         tomllib = None
>>>>>>     import tomli
       else:
    1:     tomllib = None
    1:     tomli = None
       
       
    1: def import_toml() -> None:
           global tomli
           global tomllib
>>>>>>     if sys.version_info < (3, 11):
>>>>>>         if tomli is not None:
>>>>>>             return
>>>>>>         try:
>>>>>>             import tomli
>>>>>>         except ImportError as e:  # pragma: no cover
>>>>>>             raise ImportError('tomli is not installed, run `pip install pydantic-settings[toml]`') from e
           else:
>>>>>>         if tomllib is not None:
>>>>>>             return
>>>>>>         import tomllib
       
       
    2: class TomlConfigSettingsSource(InitSettingsSource, ConfigFileSourceMixin):
    1:     """
           A source class that loads variables from a TOML file
           """
       
    3:     def __init__(
               self,
    1:         settings_cls: type[BaseSettings],
    2:         toml_file: PathType | None = DEFAULT_PATH,
           ):
>>>>>>         self.toml_file_path = toml_file if toml_file != DEFAULT_PATH else settings_cls.model_config.get('toml_file')
>>>>>>         self.toml_data = self._read_files(self.toml_file_path)
>>>>>>         super().__init__(settings_cls, self.toml_data)
       
    1:     def _read_file(self, file_path: Path) -> dict[str, Any]:
>>>>>>         import_toml()
>>>>>>         with open(file_path, mode='rb') as toml_file:
>>>>>>             if sys.version_info < (3, 11):
>>>>>>                 return tomli.load(toml_file)
>>>>>>             return tomllib.load(toml_file)
       
    1:     def __repr__(self) -> str:
>>>>>>         return f'{self.__class__.__name__}(toml_file={self.toml_file_path})'
